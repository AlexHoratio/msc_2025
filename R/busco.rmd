---
title: "BUSCO"
author: "Alex Caswell"
date: "2025-04-25"
output: html_document
---

```{r setup}

library(tidyverse)
library(ggtext)

```

```{r get_files}

busco_r003 <- read_tsv("data/busco_tsv/RAMAN_R003.tsv")
busco_r004 <- read_tsv("data/busco_tsv/RAMAN_R004.tsv")
busco_r005 <- read_tsv("data/busco_tsv/RAMAN_R005.tsv")
busco_r007 <- read_tsv("data/busco_tsv/RAMAN_R007.tsv")

busco_all <- rbind(
  busco_r003,
  busco_r004,
  busco_r005,
  busco_r007
)

```

```{r histogram_of_completeness}

completeness <- ggplot(busco_all, aes(x = `Complete`, fill=SampleName)) +
  geom_histogram(binwidth = 10, boundary = 0, closed = "left", col="grey") + 
  scale_x_continuous(breaks = seq(0, 100, 10)) +
  scale_y_continuous(breaks = seq(0, 150, 20)) + 
  scale_fill_brewer(palette = "Set1") + 
  ylab("") +
  xlab("Completeness (%)") +
  theme_classic() +
  theme(
    axis.text.y = element_markdown(size = 16),
    axis.text.x = element_markdown(size = 20),
    axis.title.x = element_markdown(size = 20),
    panel.spacing = unit(1, "lines"),
    strip.text = element_markdown(face = "bold", size = 12),
    panel.background = element_rect(fill = '#fff7ef'),
    plot.background = element_rect(fill = '#fff7ef'),
    legend.background = element_rect(fill = '#fff7ef'),
    legend.text = element_markdown(size = 12),
    legend.title = element_blank(),
  )

completeness

```

```{r boxplot_of_completeness}

boxplot_completeness <- ggplot(busco_all, aes(x = `SampleName`, y=Complete, fill=SampleName)) +
  geom_boxplot() + 
  scale_y_continuous(breaks = seq(0, 150, 20)) + 
  scale_fill_brewer(palette = "Set1") + 
  xlab("") +
  ylab("Completeness (%)") +
  theme_classic() +
  theme(
    axis.text.y = element_markdown(size = 16),
    axis.text.x = element_markdown(size = 20),
    axis.title.x = element_markdown(size = 20),
    axis.title.y = element_markdown(size = 20),
    panel.spacing = unit(1, "lines"),
    strip.text = element_markdown(face = "bold", size = 12),
    panel.background = element_rect(fill = '#fff7ef'),
    plot.background = element_rect(fill = '#fff7ef'),
    legend.background = element_rect(fill = '#fff7ef'),
    legend.text = element_markdown(size = 12),
    legend.title = element_blank(),
  )

boxplot_completeness

```


```{r gtdb}

gtdb_r003_bac120 <- read_tsv("data/gtdbtk/RAMAN_R003/gtdbtk.bac120.summary.tsv")
gtdb_r004_bac120 <- read_tsv("data/gtdbtk/RAMAN_R004/gtdbtk.bac120.summary.tsv")
gtdb_r005_bac120 <- read_tsv("data/gtdbtk/RAMAN_R005/gtdbtk.bac120.summary.tsv")
gtdb_r007_bac120 <- read_tsv("data/gtdbtk/RAMAN_R007/gtdbtk.bac120.summary.tsv")

```


